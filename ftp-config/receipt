# SliTaz package receipt.

PACKAGE="ftp-config"
VERSION="1.0"
CATEGORY="configuration"
SHORT_DESC="File transport protocol server configuration"
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="BSD"
WEB_SITE="http://tiny.slitaz.org/"
DEPENDS="base-tiny"

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/etc
}

config_form()
{
	[ "$UPLOAD" == "on" ] && UPLOAD="ckecked=ckecked " || UPLOAD=
	cat <<EOT
FTP root <input type="text" name="ROOT" >
allow upload <input type="checkbox" name="UPLOAD" $UPLOAD>
EOT
}

post_install()
{
	[ -n "$UPLOAD" ] && ROOT="-w $ROOT"
	grep -q inetd $1/etc/rcS.conf ||
	sed -i 's/^RUN_DAEMONS="/&inetd /' $1/etc/rcS.conf
	grep -q /ftpd $1/etc/inetd.conf || cat >> $1/etc/inetd.conf <<EOT
ftp	stream	tcp	nowait	root	/usr/sbin/ftpd /usr/sbin/ftpd $ROOT
EOT
}
