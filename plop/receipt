# SliTaz package receipt.

PACKAGE="plop"
VERSION="5.0.15"
CATEGORY="base-system"
SHORT_DESC="USB / IDE-CD / PCMCIA CardBus and others boot utility."
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="other"
WEB_SITE="https://www.plop.at/en/bootmanagers.html"
TARBALL="$PACKAGE-$VERSION.zip"
WGET_URL="https://download.plop.at/files/bootmngr/$TARBALL"
TARGET="i486"

BUILD_DEPENDS="xz"

# Rules to configure and make the package.
compile_rules()
{
	cp $stuff/*.S $stuff/pack .
	for i in bootloader unpack ; do
		cc -o $i.o -Wa,-a=$i.lst -c $i.S
		objcopy -O binary $i.o $i.bin
	done
	sed -i "s/VERSION/$VERSION/" pack
	./pack --build bootloader.bin unpack.bin
	./pack plpbt.bin plop
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/boot
	cp $src/plop $fs/boot/
}
